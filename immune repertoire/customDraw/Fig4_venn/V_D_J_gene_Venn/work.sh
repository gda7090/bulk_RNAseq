perl -e 'my(%abu,%sum,@smps); $tablist=shift;for(`less $tablist`){chomp;$_=~/.*\/(.*)\//;$smp=$1;push @smps,$smp;for(`less $_`){chomp; @l=split/\t/; $abu{$l[0]}{$smp} = $l[1]; $sum{$smp} += $l[1] }};END{print "GeneID\t",join("\t",@smps),"\n"; for my $g (sort keys %abu){print "$g\t"; @abu = map {$abu{$g}{$_}? $abu{$g}{$_}/$sum{$_} : 0 } @smps ; print join("\t",@abu),"\n"};}' Vgene.tab.list > Vgene.tab.xls
perl -e 'my(%abu,%sum,@smps); $tablist=shift;for(`less $tablist`){chomp;$_=~/.*\/(.*)\//;$smp=$1;push @smps,$smp;for(`less $_`){chomp;$_!~/TRB/ && next; @l=split/\t/,$_; $abu{$l[0]}{$smp} = $l[1]; $sum{$smp} += $l[1] }};END{print "GeneID\t",join("\t",@smps),"\n"; for my $g (sort keys %abu){print "$g\t"; @abu = map {$abu{$g}{$_}? $abu{$g}{$_}/$sum{$_} : 0 } @smps ; print join("\t",@abu),"\n"};}' Dgene.tab.list > Dgene.tab.xls
#ls *gene.tab.xls|perl -ne 'chomp;$_=~/(.*).tab.xls/;print "perl /NJPROJ2/MICRO/share/MetaGenome_pipeline/MetaGenome_pipeline_V5.1/lib/03.Gene_Prediction/lib/venn/draw_venn.pl --in $_ --venn venng.list --outdir $1\n"' > venn.sh
ls *gene.tab.xls|perl -ne 'chomp;$_=~/(.*).tab.xls/;print "perl draw_venn.revise.pl --in $_ --venn venng.list --outdir $1\n"' > venn.sh
